@import '../vars';
@import '../mixins';

.#{$ns}-tooltip {
  cursor: pointer;
  display: inline-block;
  overflow: hidden;

  &.#{$ns}-tooltip-inline-flex {
    display: inline-flex;
    max-width: 100%;

    &.#{$ns}-tooltip-tipopen,
    &.#{$ns}-tooltip-tipanimating,
    &.#{$ns}-has-focused-trigger {
      display: inline-block;
    }

    .#{$ns}-positioningInline {
      display: block;
    }
  }

  &.#{$ns}-tooltip-tipopen,
  &.#{$ns}-tooltip-tipanimating,
  &.#{$ns}-has-focused-trigger {
    overflow: visible;
  }
  &.#{$ns}-has-inline-trigger {
    vertical-align: bottom;

    & > *:first-child {
      display: flex;
    }
  }

  &-is-block {
    display: block;
  }

  &.#{$ns}-tooltip-limitwidth {
    max-width: 100%;
    min-width: $xui-minimum-touch-target;
  }
}

.#{$ns}-positioningInline {
  align-content: center;
  display: flex;
  height: 0;
  justify-content: center;
  position: relative;
  width: 100%;
}

// prefers-reduced-motion can be ignored here because this instance is not a motion animation
// stylelint-disable-next-line a11y/media-prefers-reduced-motion
.#{$ns}-tooltip--tip {
  @include xui-text-small;
  background-color: $xui-tooltip-bg-color;
  border-radius: $xui-radius;
  bottom: 0;
  box-shadow: 0 0 0 1px $xui-tooltip-outline-shadow-color, 0 3px 6px 0 $xui-tooltip-shadow-color;
  color: $xui-tooltip-color;
  cursor: auto;
  display: block;
  opacity: 0;
  overflow-wrap: break-word;
  padding: $xui-s-2xsmall $xui-s-xsmall;
  pointer-events: none;
  position: absolute;
  right: 0;
  text-align: center;
  transition: opacity $xui-motion-speed-fast linear, visibility $xui-motion-speed-fast linear;
  // visibility: hidden ensures the tooltip is not 'invisibly present' shortly after being closed,
  // which potentially causes an unexpected hover event. It also has much greater support than opacity for screen readers
  visibility: hidden;
  width: max-content;
  width: intrinsic; // Safari's non-standard implementation of max-content.
  // Tooltip should be above surrounding content, but below any other overlays.
  z-index: $xui-z-index-contextualtop;
  > * {
    box-sizing: border-box;
  }

  // prefers-reduced-motion can be ignored here because this instance is not a motion animation
  // stylelint-disable-next-line a11y/media-prefers-reduced-motion
  &.#{$ns}-tooltip--tip-open {
    opacity: 1;
    pointer-events: auto;
    transition: opacity $xui-motion-speed-fast linear, visibility $xui-motion-speed-fast linear;
    visibility: visible;
  }
  &.#{$ns}-tooltip--tip-animating {
    pointer-events: auto;
  }

  &:after {
    background: $xui-tooltip-bg-color;
    box-shadow: 1px 1px 0 0 $xui-tooltip-shadow-color;
    content: '';
    height: 10px;
    position: absolute;
    transform: translateX(-50%) translateY(-50%) rotate(45deg);
    transform-origin: center;
    width: 10px;
    z-index: $xui-z-index-hidden;
  }
}

// Vertically placed popups
.#{$ns}-positioningInline--content-topleft,
.#{$ns}-positioningInline--content-topcenter,
.#{$ns}-positioningInline--content-topright {
  bottom: 100%;
  &:after {
    bottom: -10px;
  }
}
.#{$ns}-positioningInline--content-bottomleft,
.#{$ns}-positioningInline--content-bottomcenter,
.#{$ns}-positioningInline--content-bottomright {
  bottom: auto;
  top: 100%;
  &:after {
    box-shadow: -1px -1px 0 0 $xui-tooltip-shadow-color;
    top: 0px;
  }
}
.#{$ns}-positioningInline--content-topleft,
.#{$ns}-positioningInline--content-bottomleft {
  left: 0;
  right: auto;
  &:after {
    left: 20px;
  }
}
.#{$ns}-positioningInline--content-topcenter,
.#{$ns}-positioningInline--content-bottomcenter {
  left: 50%; // See notes below.
  right: auto;
  transform: translateX(-50%); // See notes below.
  &:after {
    left: 50%;
  }
}
.#{$ns}-positioningInline--content-topright,
.#{$ns}-positioningInline--content-bottomright {
  right: 0px;
  &:after {
    right: 10px;
  }
}

// Horizontally placed tooltips
.#{$ns}-positioningInline--content-righttop,
.#{$ns}-positioningInline--content-rightcenter,
.#{$ns}-positioningInline--content-rightbottom {
  left: calc(100% + 10px);
  right: auto;
  &:after {
    box-shadow: -1px 1px 0 0 $xui-tooltip-shadow-color;
    left: 0px;
  }
}
.#{$ns}-positioningInline--content-lefttop,
.#{$ns}-positioningInline--content-leftcenter,
.#{$ns}-positioningInline--content-leftbottom {
  right: calc(100% + 10px);
  &:after {
    box-shadow: 1px -1px 0 0 $xui-tooltip-shadow-color;
    right: -10px;
  }
}
.#{$ns}-positioningInline--content-righttop,
.#{$ns}-positioningInline--content-lefttop {
  bottom: auto;
  top: 0;
  &:after {
    top: 15px;
  }
}
.#{$ns}-positioningInline--content-rightcenter,
.#{$ns}-positioningInline--content-leftcenter {
  bottom: auto;
  top: 50%; // See notes below.
  transform: translateY(-50%); // See notes below.
  &:after {
    top: 50%;
  }
}
.#{$ns}-positioningInline--content-rightbottom,
.#{$ns}-positioningInline--content-leftbottom {
  bottom: -100%;
  &:after {
    bottom: 5px;
  }
}

// NB: These are largely for IE, but appear harmless in Chrome, at least for now. No text blurriness observed,
// even at high zoom.
