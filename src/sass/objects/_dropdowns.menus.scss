@import "../vars";

// Menu
//
// ### Behaviour
//
// Implementations should make the most of the screen space available when showing dropdowns.
// Scrollbars can be used when there is not enough screen space to fit all menu items. When there
// is more space above than below the dropdown trigger, the menu should be positioned above the
// trigger. The same applies for whether the menu should be left-aligned or right-aligned against
// the trigger.
//
// ### Accessibility
// An example of applying ARIA attributes to a dropdown is given below, using the roles `menubar`, `menu` and `menuitem`.
// The dropdown must also provide keyboard support to be accessible, as described in the [W3C documentation on managing focus](https://www.w3.org/TR/wai-aria/usage#managingfocus).
//
// Markup:
//	<div class="xui-dropdownmenu" role="menubar" aria-label="dropdown menu">
//		<div class="xui-dropdownmenu--body">
//			<h3 class="xui-dropdownmenu--groupheading">Group Title</h3>
//			<ul class="xui-menugroup" role="menu" aria-label="Menu group 1 label">
//				<li class="xui-menugroup--item" role="menuitem" aria-selected="false">
//					<a href="#">Menu item 1</a>
//				</li>
//				<li class="xui-menugroup--item xui-menugroup--item-is-selected" role="menuitem" aria-selected="true">
//					<a href="#">Menu item 2</a>
//				</li>
//				<li class="xui-menugroup--item" role="menuitem" aria-selected="false">
//					<a href="#">Menu item 3</a>
//				</li>
//				<li class="xui-menugroup--item">
//					<label>
//						<input type="checkbox" class="xui-menugroup--input" role="menuitemcheckbox"/>
//						Menu item 4
//					</label>
//				</li>
//				<li class="xui-menugroup--item xui-is-disabled">
//					<label>
//						<input type="checkbox" class="xui-menugroup--input" role="menuitemcheckbox"/>
//						Menu item 5
//					</label>
//				</li>
//				<li class="xui-menugroup--item">
//					<label>
//						<input type="radio" name="radios" class="xui-menugroup--input" role="menuitemradio"/>
//						Menu item 6
//					</label>
//				</li>
//				<li class="xui-menugroup--item">
//					<label>
//						<input type="radio" name="radios" class="xui-menugroup--input" role="menuitemradio"/>
//						Menu item 7
//					</label>
//				</li>
//			</ul>
//			<ul class="xui-menugroup" role="menu" aria-label="Menu group 2 label">
//				<li class="xui-menugroup--item" role="menuitem">
//					<a href="http://www.google.com">Link Menu Item 1</a>
//				</li>
//				<li class="xui-menugroup--item">
//					<label>
//						<input type="checkbox" role="menuitemcheckbox"/>
//						Menu item 2
//					</label>
//				</li>
//				<li class="xui-menugroup--item">
//					<label>
//						<input type="checkbox" role="menuitemcheckbox"/>
//						Menu item 3
//					</label>
//				</li>
//				<li class="xui-menugroup--item">
//					<label>
//						<input type="radio" name="radios2" class="xui-menugroup--input" role="menuitemradio"/>
//						Menu item 4
//					</label>
//				</li>
//				<li class="xui-menugroup--item">
//					<label>
//						<input type="radio" name="radios2" class="xui-menugroup--input" role="menuitemradio"/>
//						Menu item 5
//					</label>
//				</li>
//			</ul>
//		</div>
//		<footer class="xui-dropdownmenu--footer">
//			<ul class="xui-menugroup" role="menu" aria-label="Footer menu label">
//				<li class="xui-menugroup--item" role="menuitem">
//					<a href="#">+ Some action</a>
//				</li>
//			</ul>
//		</footer>
//	</div>
//
// Styleguide: Dropdowns.1
$shadow-color: #ccc;

.#{$ns}-dropdownmenu {
	background-color: $color-panels;
	border: $border-standard;
	border-radius: $radius;
	box-shadow: $shadow-depth-2;
	font-size: 13px;
	list-style-type: none;
	margin: 0;
	overflow: hidden;
	position: absolute;
	transition: $transition-duration-quick opacity $easing-standard;
	width: 180px;
	z-index: 1;
}

.#{$ns}-dropdownmenu-is-closed {
	opacity: 0;
}

.#{$ns}-dropdownmenu--body,
.#{$ns}-dropdownmenu--footer {
	flex: 1 1 auto;
}

.#{$ns}-dropdownmenu--body {
	max-height: 350px;
	overflow: auto;
	-ms-scroll-chaining: none;
}

.#{$ns}-dropdownmenu--footer {
	border-top: $border-standard;
	box-shadow: 0 -2px 0 0 rgba($color-black, 0.05); // Should be a negative shadow variable
	z-index: 1;
}

.#{$ns}-dropdownmenu-select {
	border-color: $color-xero-blue;
	border-radius: 0 0 $radius $radius;
	border-top: 0;
	left: 1em;
	position: absolute;
	top: 100%;
	width: $inputgroup-width;
}

.#{$ns}-menugroup {
	border-top: $divider-standard;
	margin: 0;
	padding: $padding-menu-vertical 0;

	&:first-of-type {
		border-top: 0;
	}
}

.#{$ns}-menugroup--item {
	list-style-type: none;

	// FIXME: This selector is too broad-reaching
	> :nth-child(n) {
		align-items: center;
		display: flex;
		padding: $padding-menu;
		text-decoration: none;
		width: 100%;
	}

	// FIXME: This should not be an element selector
	a[href='#'] {
		color: $color-primary-text;
	}

	&:hover {
		background-color: $color-hovers;
	}
}

.#{$ns}-dropdownmenu--groupheading {
	background-color: $color-grey-6;
	border-bottom: $divider-standard;
	color: $color-secondary-text;
	font-size: $font-size-heading-mini;
	font-weight: normal;
	line-height: px-to-rem(30);
	margin: 0;
	padding: 0 $padding-menu-horizontal;

	&:nth-of-type(n+2) {
		border-top: 1px solid $color-grey-4;
	}

	& + .#{$ns}-menugroup {
		border-top: 0;
	}
}


.#{$ns}-menugroup--input {
	margin: 0 7px 0 0;
	padding: 0;
	top: 0; // doesn't work due to odd top's in _inputs.scss
	z-index: 0;
}

.#{$ns}-menugroup--item-is-selected {
	background-color: $color-xero-blue;
	color: $color-reversed-text;

	> :nth-child(n) {
		color: inherit;
	}

	// FIXME: This should not be an element selector
	a[href='#'] {
		color: $color-reversed-text;
	}

	&:hover {
		background-color: $color-xero-blue;
	}
}

.#{$ns}-menugroup--item-is-selected {
	// FIXME: These should not be element selectors
	a:hover,
	label:hover {
		background-color: $color-xero-blue;
	}
}
